---
author: "li_mingxie"
title: "【JVM】JIT编译器"
date: 2920-11-05T08:28:49+08:00
tags: [
    "java",
    "compile",
    "jit",
    "jvm",
]
categories: [
    "Java",
]
---

JIT(Just In Time Compiler)编译器
当JVM发现某个方法或代码块运行特别频繁时，就会把这些代码认定为“热点代码（Hot Spot Code）”，然后JVM会把这些代码编译成与本地平台相关的机器码，并进行各种层次的优化，完成这个任务的编译器称为：即时编译器（Just In Time Compiler，JIT）

2.3 编译器 - Compiler
只说HotSpot JVM

1. C1和C2：
HotSpot虚拟机内置了两个即时编译器，分别称为Client Compiler和Server Compiler，习惯上将前者称为C1，后者称为C2

它们俩也是JVM的分类Client VM和Server VM

HotSpot默认采用解释器和其中一个编译器直接配合的方式工作，使用那个编译器取决于虚拟机运行的模式，HotSpot会根据自身版本和宿主机器硬件性能自动选择模式，用户也可以使用“-client”或”-server”参数去指定

无论VM是Client模式还是Server模式，还有一类模式是根据使用解释器和编译器的方式来划分的：

1. 混合模式（Mixed Mode）
默认的模式，如上面描述的这种方式就是mixed mode

2. 解释模式（Interpreted Mode）
可以使用参数“-Xint”，在此模式下全部代码解释执行

3. 编译模式（Compiled Mode）
参数“-Xcomp”，此模式优先采用编译，但是无法编译时也会解释（在最新的HotSpot中此参数被取消）


HotSpot 内置两种编译器，分别是client启动时的c1编译器和server启动时的c2编译器，c2在将代码编译成机器代码的时候需要搜集大量的统计信息以便在编译的时候进行优化，因此编译出来的代码执行效率比较高，代价是程序启动时间比较长，而且需要执行比较长的时间，才能达到最高性能；与之相反， c1的目标是使程序尽快进入编译执行的阶段，所以在编译前需要搜集的信息比c2要少，编译速度因此提高很多，但是付出的代价是编译之后的代码执行效率比较低，但尽管如此，c1编译出来的代码在性能上比解释执行的性能已经有很大的提升，所以所谓的分层编译，就是一种折中方式，在系统执行初期，执行频率比较高的代码先被c1编译器编译，以便尽快进入编译执行，然后随着时间的推移，执行频率较高的代码再被c2编译器编译，以达到最高的性能。


----------------------------------------------
欢迎大家的意见和交流

`email: li_mingxie@163.com`